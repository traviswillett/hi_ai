<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">

  {%- include head.html -%}

  <body>

    {%- include header.html -%}

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {{ content }}
      </div>
    </main>

    {%- include footer.html -%}

    <!-- Mermaid.js for flowcharts -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        mermaid.initialize({
          startOnLoad: false,
          theme: 'default',
          themeVariables: {
            primaryColor: '#3742fa',
            primaryTextColor: '#2c3e50',
            primaryBorderColor: '#5352ed',
            lineColor: '#667eea',
            secondaryColor: '#f8f9fa',
            tertiaryColor: '#e9ecef'
          },
          flowchart: {
            htmlLabels: true,
            curve: 'basis'
          }
        });

        // Find all code blocks with mermaid class and render them
        const mermaidElements = document.querySelectorAll('pre code.language-mermaid, .language-mermaid');
        mermaidElements.forEach((element, index) => {
          const graphDefinition = element.textContent;
          const graphId = 'mermaid-graph-' + index;
          const graphDiv = document.createElement('div');
          graphDiv.className = 'mermaid';
          graphDiv.id = graphId;
          graphDiv.innerHTML = graphDefinition;
          element.parentNode.replaceWith(graphDiv);
        });

        // Also handle direct mermaid class elements
        const directMermaidElements = document.querySelectorAll('.mermaid');
        if (directMermaidElements.length > 0) {
          mermaid.run();
        }
      });
    </script>

  </body>

</html>